---
title: 桌面助手
description: 如何开发一个桌面助手
---

=================
桌面助手
=================

由于浏览器功能有限，一些特殊的功能，必须借助桌面助手来完成，比如：

- 外部编辑
- 文件下载同步
- 支持断点续传的同步

工作原理
==================
桌面助手就是一个安装在用户电脑上的一个辅助程序，一旦安装，这个程序注册为和浏览器的一个外部协议。

如外部编辑::

   edo-windows://edit/http://192.168.1.88:8089/files/abc.doc?token=12312312

文件下载同步::

   edo-windows://download/http://192.168.1.88:8089/?token=12312312&account=zopen&instance=default&uid=12312312

文件上传同步::

   edo-windows://upload/http://192.168.1.88:8089/?token=12312312&account=zopen&instance=default&uid=12312312

点击后直接调用::

   c:\edo\edowindows.exe -u "download/http://192.168.1.88:8089/?token=12312312&account=zopen&instance=default&uid=12312312"

桌面助手启动之后，解读参数：

- download: 表示同步下载，也可能是upload、edit
- http://192.168.1.88:8089 : 系统账户中心api地址
- token: 读取token信息，利用系统的开放api来完成后续功能
- account
- instance

文件下载同步
======================

启动下载同步，首先会检查之前是否下载过。
如果下载过，则提示用户之前下载的文件夹位置，点击确定之后开始下载。

下载的过程中，会找到变化的部分(调用/delta)，增量下载，减少下载时间，并能显示进度情况::

  有3个文件新增，12个文件发生变化，正在同步...

具体：

- 如果本地文件有变化，则属于冲突情况，应该将保留下载文件改名存放

  - 如何判断冲突已经解决？
  - 如果没有解决冲突，再次更新新版本呢？
  - 需要明显提示冲突信息

- 同步下载如果发生中断，自动断点续传，下载大文件更加平滑。

文件上传同步
================

检查本地的文件的变化，上传。可以做到：

- 自动找到发生变化的文件，包括改名、移动、删除、修改，向服务器发起相应的操作
- 如果服务器的文件版本发生变化，则上传冲突，一旦冲突，需要先同步下载解决冲突，才能完成上传


